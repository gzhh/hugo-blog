<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="gzhh">
<meta name="description" content="gzhh&#39;s personal website">
<meta name="keywords" content="blog,developer,personal">


  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Lua 语言入门（一）">
  <meta name="twitter:description" content="gzhh&#39;s personal website">

<meta property="og:url" content="http://localhost:1313/posts/play-lua-first/">
  <meta property="og:site_name" content="gzhh&#39;s blog">
  <meta property="og:title" content="Lua 语言入门（一）">
  <meta property="og:description" content="gzhh&#39;s personal website">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2019-09-29T20:20:36+08:00">
    <meta property="article:modified_time" content="2019-09-29T20:20:36+08:00">
    <meta property="article:tag" content="Lua">



  <title>gzhh&#39;s blog</title>

  
  <link rel="canonical" href="http://localhost:1313/posts/play-lua-first/">
  

  <link rel="preload" href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.css" media="screen">





  
  
    
    
    <link rel="stylesheet" href="/css/coder-dark.css" media="screen">
  



   




  <link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">


  <link rel="alternate" type="application/rss+xml" href="/categories/concurrency/index.xml" title="gzhh's blog" />


  <meta name="generator" content="Hugo 0.131.0">


  

</head>







<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="/">
      gzhh&#39;s blog
    </a>
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link" href="/posts/">Posts</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="/read/">Read</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="/about/">About</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="http://localhost:1313/posts/play-lua-first/">
              Lua 语言入门（一）
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa fa-calendar" aria-hidden="true"></i>
              <time datetime="2019-09-29T20:20:36&#43;08:00">
                September 29, 2019
              </time>
            </span>
            <span class="reading-time">
              <i class="fa fa-clock-o" aria-hidden="true"></i>
              6-minute read
            </span>
          </div>
          
          <div class="categories">
  <i class="fa fa-folder" aria-hidden="true"></i>
    <a href="/categories/lua/">Lua</a></div>

          <div class="tags">
  <i class="fa fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="/tags/lua/">Lua</a>
    </span></div>

        </div>
      </header>

      <div>
        
        <h3 id="说在前面">
  说在前面
  <a class="heading-link" href="#%e8%af%b4%e5%9c%a8%e5%89%8d%e9%9d%a2">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<p>由于前段时间使用 Redis 相关技术接触到了 Lua 脚本用于提升 Redis 性能，再加上之前对 Nginx
可以使用 Lua 技术进行扩展非常感兴趣，所以这段时间抽空学习了下Lua，现在把自己初学 Lua 的
经历记录下来，供自己与各位同行参考和交流。</p>
<ul>
<li>
<p>1.代码块
进入交互模式
lua
执行 lua 脚本后进入交互模式
Lua -i test.lua
交互模式中执行 lua 脚本
dofile(&ldquo;test.lua&rdquo;)</p>
</li>
<li>
<p>2.词法惯例
标识符：大小写敏感
注释：单行&ndash;，多行&ndash;[[]]&ndash;，只有第一行和最后一行被注释&mdash;[[]]&ndash;
分号：两条语句之间可写可不写</p>
</li>
<li>
<p>3.全局变量
默认 nil</p>
</li>
<li>
<p>4.变量和类型
由于 Lua 是动态语言，所以变量没有类型，但是每个值都有它们自己的类型
八个基本类型：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>value:
</span></span><span style="display:flex;"><span>&gt; type(nil)			  --&gt; nil
</span></span><span style="display:flex;"><span>&gt; type(true)           --&gt; boolean
</span></span><span style="display:flex;"><span>&gt; type(10.4 * 3)       --&gt; number
</span></span><span style="display:flex;"><span>&gt; type(&#34;Hello world&#34;)  --&gt; string
</span></span><span style="display:flex;"><span>&gt; type(io.stdin)       --&gt; userdata
</span></span><span style="display:flex;"><span>&gt; type(print)          --&gt; function
</span></span><span style="display:flex;"><span>&gt; type(type)           --&gt; function
</span></span><span style="display:flex;"><span>&gt; type({})             --&gt; table
</span></span><span style="display:flex;"><span>&gt; type(type(X))        --&gt; string
</span></span></code></pre></div></li>
<li>
<p>5.基本类型
Boolean: 在条件判断中 false 和 nil 被当作 false，其他都被当作 ture。lua 的三元操作符和别的语言不一样</p>
</li>
<li>
<p>6.命令行
lua 					进入交互模式
lua -i test.lua 	    执行脚本后进入交互模式
lua -e &ldquo;&hellip;&rdquo;		    执行 lua 代码并在终端打印出来
lua -l libname	    加载一个 library</p>
</li>
<li>
<p>7.数字类型
值相等的两个整数和浮点数之间是相等的，可以用math.type来判断数字的确切类型。
1 == 1.0 // true
type(1) // number
type(1.0) // number
math.type(1) // integer
math.type(1.0) // float</p>
</li>
<li>
<p>8.算术操作符
加 减 乘 除 整除 取余 + - * / // %
9 // 2 &ndash;&gt; 4
-9 // 2 &ndash;&gt; -5
a % b == a - ((a // b) * b)</p>
</li>
<li>
<p>9.关系操作符
lt gt le ge eq nee &lt; &gt; &lt;= &gt;= == ~=
使用 == 或 ~= 时，如果两个值是不同的类型，lua 就认为它们是不想等的，否则，
lua 才会根据类型比较它们的值。</p>
</li>
<li>
<p>10.math 库
数学函数、三角函数、对数函数等
随机数：
math.randomseed(os.time())
math.random()</p>
</li>
<li>
<p>11.字符串类型
a = &ldquo;hello &quot;
b = &lsquo;world&rsquo;
字符串长度 #a #&ldquo;hello world&rdquo;
字符串拼接 a .. b
长字符串：
html = [[
&hellip;
]]</p>
</li>
<li>
<p>12.number 和 string 之间的转换
隐式类型转换：
10..20 &ndash;&gt; 1020 类型为 string
&ldquo;10&rdquo; + 1 &ndash;&gt; 11.0 类型为 number
显式类型转换：
tonumber(str) // 如果str可以解释为number值，返回integers或floats，否则返回 nil</p>
</li>
<li>
<p>13.字符串库</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>&gt; string.rep(&#34;abc&#34;, 3)				--&gt; abcabcabc
</span></span><span style="display:flex;"><span>&gt; string.reverse(&#34;A Long Line!&#34;)	--&gt; !eniL gnoL A
</span></span><span style="display:flex;"><span>&gt; string.lower(&#34;A Long Line!&#34;)		--&gt; a long line!
</span></span><span style="display:flex;"><span>&gt; string.upper(&#34;A Long Line!&#34;)		--&gt; A LONG LINE!
</span></span><span style="display:flex;"><span>&gt; string.sub(s, i, j)				--&gt; from the ith to the jth character
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(string.char(97))						--&gt; a
</span></span><span style="display:flex;"><span>i = 99; print(string.char(i, i+1, i+2))		--&gt; cde
</span></span><span style="display:flex;"><span>print(string.byte(&#34;abc&#34;))					--&gt; 97
</span></span><span style="display:flex;"><span>print(string.byte(&#34;abc&#34;, 2))				--&gt; 98
</span></span><span style="display:flex;"><span>print(string.byte(&#34;abc&#34;, -1))				--&gt; 99
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>string.format(&#34;x = %d  y = %d&#34;, 10, 20)		--&gt; x = 10  y = 20
</span></span><span style="display:flex;"><span>string.format(&#34;x = %f&#34;, 200)				--&gt; x = 200.000000
</span></span><span style="display:flex;"><span>&gt; tag, title = &#34;h1&#34;, &#34;a title&#34;
</span></span><span style="display:flex;"><span>&gt; string.format(&#34;&lt;%s&gt;%s&lt;/%s&gt;&#34;, tag, title, tag)
</span></span><span style="display:flex;"><span>--&gt; &lt;h1&gt;a title&lt;/h1&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt; string.find(&#34;hello world&#34;, &#34;wor&#34;)   --&gt; 7   9
</span></span><span style="display:flex;"><span>&gt; string.find(&#34;hello world&#34;, &#34;war&#34;)   --&gt; nil
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt; string.gsub(&#34;hello world&#34;, &#34;l&#34;, &#34;.&#34;)		--&gt; he..o wor.d    3
</span></span><span style="display:flex;"><span>&gt; string.gsub(&#34;hello world&#34;, &#34;ll&#34;, &#34;..&#34;)	--&gt; he..o world    1
</span></span><span style="display:flex;"><span>&gt; string.gsub(&#34;hello world&#34;, &#34;a&#34;, &#34;.&#34;)		--&gt; hello world    0
</span></span></code></pre></div></li>
<li>
<p>14.utf-8 支持</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>utf8.len(&#34;résumé&#34;) --&gt; 2
</span></span><span style="display:flex;"><span>utf8.char(114, 233, 115, 117, 109, 233) --&gt; résumé
</span></span><span style="display:flex;"><span>utf8.codepoint(&#34;résumé&#34;, 6, 7)          --&gt; 109    233
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt; s = &#34;Nähdään&#34;
</span></span><span style="display:flex;"><span>&gt; utf8.codepoint(s, utf8.offset(s, 5))  --&gt; 228
</span></span><span style="display:flex;"><span>&gt; utf8.char(228)						--&gt; ä
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>for i, c in utf8.codes(&#34;Ação&#34;) do
</span></span><span style="display:flex;"><span>	print(i, c)
</span></span><span style="display:flex;"><span>end
</span></span><span style="display:flex;"><span>  --&gt; 1    65
</span></span><span style="display:flex;"><span>  --&gt; 2    231
</span></span><span style="display:flex;"><span>  --&gt; 4    227
</span></span><span style="display:flex;"><span>  --&gt; 6    111
</span></span></code></pre></div></li>
<li>
<p>15.Tables</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span><span style="">可以用</span> tables <span style="">表示</span> arrays, sets, structs, records
</span></span><span style="display:flex;"><span>// <span style="">数组</span>
</span></span><span style="display:flex;"><span>a = {}
</span></span><span style="display:flex;"><span>a[<span style="font-style:italic">&#34;x&#34;</span>] = 10
</span></span><span style="display:flex;"><span>b = a						-- <span style="font-style:italic">&#39;b&#39;</span> refers to the same table as <span style="font-style:italic">&#39;a&#39;</span>
</span></span><span style="display:flex;"><span>b[<span style="font-style:italic">&#34;x&#34;</span>]
</span></span><span style="display:flex;"><span>b[<span style="font-style:italic">&#34;x&#34;</span>] = 20
</span></span><span style="display:flex;"><span>a[<span style="font-style:italic">&#34;x&#34;</span>]						-- 20
</span></span><span style="display:flex;"><span>a = nil						-- only <span style="font-style:italic">&#39;b&#39;</span> still refers to the table
</span></span><span style="display:flex;"><span>b = nil						-- no references left to the table
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// <span style="">结构体</span>
</span></span><span style="display:flex;"><span>&gt; a = {}					-- empty table
</span></span><span style="display:flex;"><span>&gt; a.x = 10				    -- same as a[<span style="font-style:italic">&#34;x&#34;</span>] = 10
</span></span><span style="display:flex;"><span>&gt; a.x						-- same as a[<span style="font-style:italic">&#34;x&#34;</span>]
</span></span><span style="display:flex;"><span>&gt; a.y						-- same as a[<span style="font-style:italic">&#34;y&#34;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// table constructors (<span style="">可以不同形式，不同类型，可以多层嵌套</span>)
</span></span><span style="display:flex;"><span>days = {<span style="font-style:italic">&#34;Sunday&#34;</span>, <span style="font-style:italic">&#34;Monday&#34;</span>, <span style="font-style:italic">&#34;Tuesday&#34;</span>, <span style="font-style:italic">&#34;Wednesday&#34;</span>, <span style="font-style:italic">&#34;Thursday&#34;</span>, <span style="font-style:italic">&#34;Friday&#34;</span>, <span style="font-style:italic">&#34;Saturday&#34;</span>}
</span></span><span style="display:flex;"><span>print(days[4])  --&gt; Wednesday
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>a = {x = 10, y = 20}
</span></span><span style="display:flex;"><span>a = {}; a.x = 10; a.y = 20
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>a = {[1] = <span style="font-style:italic">&#34;red&#34;</span>, [2] = <span style="font-style:italic">&#34;green&#34;</span>, [3] = <span style="font-style:italic">&#34;blue&#34;</span>,}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// array <span style="font-weight:bold">or</span> list
</span></span><span style="display:flex;"><span>-- read 10 lines, storing them <span style="font-weight:bold">in</span> a table
</span></span><span style="display:flex;"><span>a = {}
</span></span><span style="display:flex;"><span><span style="font-weight:bold">for</span> i = 1, 10 <span style="font-weight:bold">do</span>
</span></span><span style="display:flex;"><span>	a[i] = io.read()
</span></span><span style="display:flex;"><span>end
</span></span><span style="display:flex;"><span> -- print the lines, from 1 to <span style="font-style:italic">#a</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">for</span> i = 1, <span style="font-style:italic">#a do</span>
</span></span><span style="display:flex;"><span>  print(a[i])
</span></span><span style="display:flex;"><span>end
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// table <span style="">遍历</span>
</span></span><span style="display:flex;"><span>// key<span style="">–</span>value pairs
</span></span><span style="display:flex;"><span>t = {10, print, x = 12, k = <span style="font-style:italic">&#34;hi&#34;</span>}
</span></span><span style="display:flex;"><span><span style="font-weight:bold">for</span> k, v <span style="font-weight:bold">in</span> pairs(t) <span style="font-weight:bold">do</span>
</span></span><span style="display:flex;"><span>	print(k, v)
</span></span><span style="display:flex;"><span>end
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// list
</span></span><span style="display:flex;"><span>t = {10, print, 12, <span style="font-style:italic">&#34;hi&#34;</span>}
</span></span><span style="display:flex;"><span><span style="font-weight:bold">for</span> k, v <span style="font-weight:bold">in</span> ipairs(t) <span style="font-weight:bold">do</span>
</span></span><span style="display:flex;"><span>	print(k, v)
</span></span><span style="display:flex;"><span>end
</span></span><span style="display:flex;"><span><span style="font-weight:bold">for</span> k = 1, <span style="font-style:italic">#t do</span>
</span></span><span style="display:flex;"><span>	print(k, t[k])
</span></span><span style="display:flex;"><span>end
</span></span></code></pre></div></li>
<li>
<p>16.table 库</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>t = {}
</span></span><span style="display:flex;"><span>for line in io.lines() do
</span></span><span style="display:flex;"><span>	table.insert(t, line)
</span></span><span style="display:flex;"><span>end
</span></span><span style="display:flex;"><span>print(#t)         --&gt; (number of lines read)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>table.insert(t, x)
</span></span><span style="display:flex;"><span>table.remove(t)
</span></span><span style="display:flex;"><span>table.move(a, f, e, t)	--&gt; 将索引 f 至 e 对应的元素移至 t 
</span></span></code></pre></div></li>
<li>
<p>17.函数</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>// 函数例子
</span></span><span style="display:flex;"><span>-- add the elements of sequence &#39;a&#39;
</span></span><span style="display:flex;"><span>function add (a)
</span></span><span style="display:flex;"><span>	local sum = 0
</span></span><span style="display:flex;"><span>	for i = 1, #a do
</span></span><span style="display:flex;"><span>		sum = sum + a[i]
</span></span><span style="display:flex;"><span>	end
</span></span><span style="display:flex;"><span>	return sum
</span></span><span style="display:flex;"><span>end
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>function f (a, b) print(a, b) end
</span></span><span style="display:flex;"><span>f()				--&gt; nil    nil
</span></span><span style="display:flex;"><span>f(3)			--&gt; 3      nil
</span></span><span style="display:flex;"><span>f(3, 4)			--&gt; 3      4
</span></span><span style="display:flex;"><span>f(3, 4, 5)		--&gt; 3      4      (5 is discarded)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// 多个返回值
</span></span><span style="display:flex;"><span>function maximum (a)
</span></span><span style="display:flex;"><span>  local mi = 1					-- index of the maximum value
</span></span><span style="display:flex;"><span>  local m = a[mi]				-- maximum value
</span></span><span style="display:flex;"><span>  for i = 1, #a do
</span></span><span style="display:flex;"><span>    if a[i] &gt; m then
</span></span><span style="display:flex;"><span>      mi = i; m = a[i]
</span></span><span style="display:flex;"><span>	end end
</span></span><span style="display:flex;"><span>  return m, mi					-- return the maximum and its index
</span></span><span style="display:flex;"><span>end
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>function foo0 () end						-- returns no results
</span></span><span style="display:flex;"><span>function foo1 () return &#34;a&#34; end				-- returns 1 result
</span></span><span style="display:flex;"><span>function foo2 () return &#34;a&#34;, &#34;b&#34; end		-- returns 2 results
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// 可变函数
</span></span><span style="display:flex;"><span>function add (...)
</span></span><span style="display:flex;"><span>  local s = 0
</span></span><span style="display:flex;"><span>  for _, v in ipairs{...} do
</span></span><span style="display:flex;"><span>s=s+ v end
</span></span><span style="display:flex;"><span>return s end
</span></span><span style="display:flex;"><span>print(add(3, 4, 10, 25, 12)) --&gt; 54
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>function nonils (...)
</span></span><span style="display:flex;"><span>  local arg = table.pack(...)
</span></span><span style="display:flex;"><span>  for i = 1, arg.n do
</span></span><span style="display:flex;"><span>  	if arg[i] == nil then return false end
</span></span><span style="display:flex;"><span>  end
</span></span><span style="display:flex;"><span>  return true
</span></span><span style="display:flex;"><span>end
</span></span><span style="display:flex;"><span>print(nonils(2,3,nil))	--&gt; false
</span></span><span style="display:flex;"><span>print(nonils(2,3))		--&gt; true
</span></span><span style="display:flex;"><span>print(nonils())			--&gt; true
</span></span><span style="display:flex;"><span>print(nonils(nil))	    --&gt; false
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(select(1, &#34;a&#34;, &#34;b&#34;, &#34;c&#34;))		--&gt; a    b    c
</span></span><span style="display:flex;"><span>print(select(2, &#34;a&#34;, &#34;b&#34;, &#34;c&#34;))		--&gt; b    c
</span></span><span style="display:flex;"><span>print(select(3, &#34;a&#34;, &#34;b&#34;, &#34;c&#34;))		--&gt; c
</span></span><span style="display:flex;"><span>print(select(&#34;#&#34;, &#34;a&#34;, &#34;b&#34;, &#34;c&#34;))	--&gt; 3
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(table.unpack{10,20,30})    --&gt; 10   20   30
</span></span><span style="display:flex;"><span>a,b = table.unpack{10,20,30}     -- a=10, b=20, 30 is discarded
</span></span></code></pre></div></li>
<li>
<p>18.IO</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>一、简单io
</span></span><span style="display:flex;"><span>io.write(str)
</span></span><span style="display:flex;"><span>io.write(str1, str2, str3)		--&gt; 连续打印几个字符串
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>io.read()
</span></span><span style="display:flex;"><span>--[[
</span></span><span style="display:flex;"><span>&#34;a&#34; 读整个文件
</span></span><span style="display:flex;"><span>&#34;l&#34; 读下一行(舍掉新行)
</span></span><span style="display:flex;"><span>&#34;L&#34; 读下一行(保留新行)
</span></span><span style="display:flex;"><span>&#34;n&#34; 读一个数字
</span></span><span style="display:flex;"><span>num 读num个字符作为一个字符串(字符不够的就按输入字符计，字符过多的则舍掉多余的字符)
</span></span><span style="display:flex;"><span>--]]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>--[[
</span></span><span style="display:flex;"><span>例子：排序一个文件
</span></span><span style="display:flex;"><span>local lines = {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-- read the lines lin table &#39;lines&#39;
</span></span><span style="display:flex;"><span>for line in io.lines() do
</span></span><span style="display:flex;"><span>    lines[#lines + 1] = line
</span></span><span style="display:flex;"><span>end
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-- sort
</span></span><span style="display:flex;"><span>table.sort(lines)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-- write all the lines
</span></span><span style="display:flex;"><span>for _, l in ipairs(lines) do
</span></span><span style="display:flex;"><span>    io.write(l, &#34;\n&#34;)
</span></span><span style="display:flex;"><span>end
</span></span><span style="display:flex;"><span>--]]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>--[[
</span></span><span style="display:flex;"><span>for count = 1, math.huge do
</span></span><span style="display:flex;"><span>    local line = io.read(&#34;L&#34;)
</span></span><span style="display:flex;"><span>    if line == nil then break end
</span></span><span style="display:flex;"><span>    io.write(string.format(&#34;%6d  &#34;, count), line)
</span></span><span style="display:flex;"><span>end
</span></span><span style="display:flex;"><span>--]]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>--[[
</span></span><span style="display:flex;"><span>local count = 0
</span></span><span style="display:flex;"><span>for line in io.lines() do
</span></span><span style="display:flex;"><span>    count = count + 1
</span></span><span style="display:flex;"><span>    io.write(string.format(&#34;%6d  &#34;, count), line, &#34;\n&#34;)
</span></span><span style="display:flex;"><span>end
</span></span><span style="display:flex;"><span>--]]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>--[[
</span></span><span style="display:flex;"><span>while true do
</span></span><span style="display:flex;"><span>    local block = io.read(2^13)          -- block size is 8K
</span></span><span style="display:flex;"><span>    if not block then break end
</span></span><span style="display:flex;"><span>    io.write(block)
</span></span><span style="display:flex;"><span>end
</span></span><span style="display:flex;"><span>--]]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>--[[
</span></span><span style="display:flex;"><span>while true do
</span></span><span style="display:flex;"><span>    local n1, n2, n3 = io.read(&#34;n&#34;, &#34;n&#34;, &#34;n&#34;)
</span></span><span style="display:flex;"><span>    if not n1 then break end
</span></span><span style="display:flex;"><span>    print(math.max(n1, n2, n3))
</span></span><span style="display:flex;"><span>end
</span></span><span style="display:flex;"><span>--]]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>二、完全io
</span></span><span style="display:flex;"><span>file = io.open (filename [, mode])
</span></span><span style="display:flex;"><span>--[[
</span></span><span style="display:flex;"><span>r 只读
</span></span><span style="display:flex;"><span>w 只写
</span></span><span style="display:flex;"><span>a 附加写
</span></span><span style="display:flex;"><span>r+ 读写(文件必须存在)
</span></span><span style="display:flex;"><span>w+ 读写(文件不存在则可以自己创建)
</span></span><span style="display:flex;"><span>a+ 读写(附加写)
</span></span><span style="display:flex;"><span>b 二进制模式
</span></span><span style="display:flex;"><span>--]]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>local f = assert(io.open(filename, mode))		--&gt; 使用assert检查错误
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>local f = assert(io.open(filename, &#34;r&#34;))
</span></span><span style="display:flex;"><span>local t = f:read(&#34;a&#34;)
</span></span><span style="display:flex;"><span>f:close()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>预定义 C streams
</span></span><span style="display:flex;"><span>io.stdin, io.stdout, io.stderr
</span></span><span style="display:flex;"><span>t = io.stdin:read()
</span></span><span style="display:flex;"><span>io.stdout:write(t)
</span></span><span style="display:flex;"><span>-- io.stderr:write(&#39;this is error stream&#39;)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>输入输出的几种方式
</span></span><span style="display:flex;"><span>io.read()
</span></span><span style="display:flex;"><span>io.input()
</span></span><span style="display:flex;"><span>io.stdin:read()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>io.write(&#39;hello world&#39;)
</span></span><span style="display:flex;"><span>io.output():write(&#39;hello world&#39;)
</span></span><span style="display:flex;"><span>io.stdout:write(&#39;hello world&#39;)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>三、其他文件操作
</span></span><span style="display:flex;"><span>io.flush() -- 把当前输出流刷新到磁盘
</span></span><span style="display:flex;"><span>f:flush() -- 刷流f到磁盘
</span></span><span style="display:flex;"><span>f:seek() -- get或set在文件中一个流的位置
</span></span></code></pre></div></li>
<li>
<p>19.os 函数</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>os.rename -- 重命名文件
</span></span><span style="display:flex;"><span>os.remove -- 删除文件
</span></span><span style="display:flex;"><span>os.getenv(&#34;HOME&#34;) -- 环境变量
</span></span><span style="display:flex;"><span>os.execute -- 执行系统命令
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>function createDir (dirname)
</span></span><span style="display:flex;"><span>	os.execute(&#34;mkdir &#34; .. dirname)
</span></span><span style="display:flex;"><span>end
</span></span></code></pre></div></li>
<li>
<p>20.流程控制结构</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>if then else
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>while
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>repeat until
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>for 有两种形式
</span></span><span style="display:flex;"><span>1.Numerical for
</span></span><span style="display:flex;"><span>for i = 1, #a do
</span></span><span style="display:flex;"><span>	something
</span></span><span style="display:flex;"><span>end
</span></span><span style="display:flex;"><span>2.Generic for
</span></span><span style="display:flex;"><span>-- pairs, ipairs, io.lines()
</span></span><span style="display:flex;"><span>for k, v in ipairs(t) do
</span></span><span style="display:flex;"><span>	something
</span></span><span style="display:flex;"><span>end
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>break, return, goto
</span></span></code></pre></div></li>
</ul>
      </div>


      <footer>
        


        <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "gzhh-tech" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
      2017 -
    
    2025
     gzhh 
    ·
    
    Powered by <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
    
  </section>
</footer>

  </main>

  
  
  <script src="/js/coder.js"></script>
  

  

  
  



  

  

  

  

  

  
</body>

</html>
